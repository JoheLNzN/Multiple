var _myObject=getJSONFromDBFake(),_dtp="#datepicker",_daysSelected=[];$(_dtp).datepick({firstDay:1,monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Setiembre","Octubre","Noviembre","Diciembre"],monthNamesShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Set","Oct","Nov","Dic"],dayNames:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],dayNamesShort:["Dom","Lun","Mar","Mie","Jue","Vie","Sáb"],dayNamesMin:["Dom","Lun","Mar","Mie","Jue","Vie","Sáb"],prevText:"",nextText:"",todayText:"Hoy",prevStatus:"",nextStatus:"",todayStatus:"",monthStatus:"",yearStatus:"",currentStatus:"",dayStatus:"",multiSelect:999,dateFormat:"dd/MM/yyyy",onSelect:function(e){configDatePicker(_myObject)}});var sd=_myObject.Project.StartDate.split("/"),ed=_myObject.Project.EndDate.split("/"),startDate=new Date(sd[2],sd[1]-1,sd[0]),endDate=new Date(ed[2],ed[1]-1,ed[0]);function getRangeDates(e,t){for(var a=[];e<=t;)a.push(new Date(e)),e.setDate(e.getDate()+1);return a}function hexToRgbA(e,t){var a;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(e))return 3==(a=e.substring(1).split("")).length&&(a=[a[0],a[0],a[1],a[1],a[2],a[2]]),"rgba("+[(a="0x"+a.join(""))>>16&255,a>>8&255,255&a].join(",")+", "+t+")";throw new Error("Bad Hex")}function configDatePicker(e){if(null!=e&&null!=e){var t,a,n,d;if(null!=e.Project){if(t=null==e.Project.Color?"#417AFF":e.Project.Color,null!=e.Project.Event)switch(e.Project.Event.length){case 0:console.log("No hay eventos :(");break;case 1:a=e.Project.Event[0].Color;break;case 2:a=e.Project.Event[0].Color,n=e.Project.Event[1].Color;break;default:a=e.Project.Event[0].Color,n=e.Project.Event[1].Color,d=e.Project.Event[2].Color}}else t="#417AFF",a="red",n="white",d="red";var s=$(document).find(_dtp);s.find(".datepick-today").css("background-color","#A3CB38"),s.find("a.datepick-cmd-today").css("background-color",t),s.find(".datepick-month-header input").css("color",t),s.find(".datepick-month-header select").css("color",t),s.find("a.datepick-selected").css("background-color",t),customSnakeDays(_myObject),s.find(".datepick .li-1").css("background-color",a),s.find(".datepick .li-2").css("background-color",n),s.find(".datepick .li-3").css("background-color",d),s.find(".isSnake span.side-a").css("background-color",hexToRgbA(t,".15")),s.find(".isSnake-first span.side-a-first").css("background-color",hexToRgbA(t,".15")),s.find(".isSnake-last span.side-a-last").css("background-color",hexToRgbA(t,".15")),s.find(".datepick .datepick-cmd-next").css("background-color",hexToRgbA(t,".15")),s.find(".datepick .datepick-cmd-prev").css("background-color",hexToRgbA(t,".15"))}else console.log("El objeto es nulo o no ha sido definido")}function customSnakeDays(e){var t=$(document).find("#datepicker");t.find("tbody");t.find("tbody tr").each((function(t,a){var n=$(a);n.find("td").each((function(t,a){var d=t,s=t-1,i=t+1,c="<ul>";if(null!=e.Project.Event){switch(e.Project.Event.length){case 0:c="";break;case 1:c+="<li class='li-1'></li>";break;case 2:c+="<li class='li-1'></li><li class='li-2'></li>";break;default:c+="<li class='li-1'></li><li class='li-2'></li><li class='li-3'></li>"}""==c?console.log("No hay eventos"):(c+="</ul>",dayIsSelected(n,d)&&(n.find("td").eq(d).find("ul").remove(),n.find("td").eq(d).append(c)))}if(dayIsSelected(n,s)||dayIsSelected(n,i))if(s>=0){if(dayIsSelected(n,s)&&dayIsSelected(n,i)){n.find("td").eq(d).removeClass().addClass("isSnake");var o="<span class='side-a'></span>";n.find("td").eq(d).find("span.side-a").remove(),n.find("td").eq(d).append(o)}if(!dayIsSelected(n,i)&&(n.find("td").eq(d).removeClass().addClass("isSnake-last"),n.find("td").eq(d).has("a.datepick-selected").length>0)){o="<span class='side-a-last'></span>";n.find("td").eq(d).find("span.side-a-last").remove(),n.find("td").eq(d).append(o)}if(!dayIsSelected(n,s)&&(n.find("td").eq(d).removeClass().addClass("isSnake-first"),n.find("td").eq(d).has("a.datepick-selected").length>0)){o="<span class='side-a-first'></span>";n.find("td").eq(d).find("span.side-a-first").remove(),n.find("td").eq(d).append(o)}}else if(dayIsSelected(n,i)&&(n.find("td").eq(d).removeClass().addClass("isSnake-first"),n.find("td").eq(d).has("a.datepick-selected").length>0)){o="<span class='side-a-first'></span>";n.find("td").eq(d).find("span.side-a-first").remove(),n.find("td").eq(d).append(o)}}))}))}function dayIsSelected(e,t){return e.find("td").eq(t).find("a").hasClass("datepick-selected")}function changeSizeDay(){var e=$(_dtp).find("table thead tr:first th:first").width();$(_dtp).find("table tbody tr td").css("height",e+"px")}$(_dtp).datepick("setDate",getRangeDates(startDate,endDate)),$(_dtp).on("click",(function(){configDatePicker(_myObject),changeSizeDay()})),configDatePicker(_myObject),$(window).on("resize",(function(){changeSizeDay()})),changeSizeDay(),$(_dtp).on("click","tbody td a.datepick-selected",(function(e){if(e.preventDefault(),null!=_myObject&&null!=_myObject.Project&&null!=_myObject.Project.Event&&null!=_myObject.Project.Event){var t=_myObject.Project.Event;$("div.c-events-inner").find("div.event").remove(),$.each(t,(function(e,t){var a="<div class='event' style='background-color: "+t.Color+"'><span class='event-title'>"+t.Title+"</span> <p class='event-details'>"+t.Details+"</p></div>";$("div.c-events-inner").append(a)}))}}));